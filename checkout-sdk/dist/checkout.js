!function(){"use strict";const n={open(n,e){const a=document.createElement("div");a.id="pg-root",a.innerHTML=`\n      <div class="pg-backdrop"></div>\n\n      <div class="pg-box pg-animate-in">\n        <button class="pg-close-btn" aria-label="Close payment modal">&times;</button>\n\n        <div class="pg-header">\n          <div>\n            <h2>Complete your payment</h2>\n            <p class="pg-subtitle">${n.merchantName??"Secure checkout"}</p>\n          </div>\n          <div class="pg-amount-chip">\n            <span>Payable</span>\n            <strong>â‚¹${(n.amount/100).toFixed(2)}</strong>\n          </div>\n        </div>\n\n        <div class="pg-tabs">\n          <button class="pg-tab pg-tab-active" data-tab="card">Cards</button>\n          <button class="pg-tab" data-tab="upi">UPI</button>\n          <button class="pg-tab" data-tab="wallet">Wallets</button>\n          <button class="pg-tab" data-tab="netbanking">Netbanking</button>\n          <button class="pg-tab" data-tab="cod">Cash on delivery</button>\n        </div>\n\n        <div class="pg-body">\n          \x3c!-- Card form --\x3e\n          <div class="pg-tab-panel" data-panel="card">\n            <div class="pg-card-row">\n              <input class="pg-input" id="pg-card-num" placeholder="Card number" />\n              <div class="pg-card-brands">\n                <span class="pg-pill">VISA</span>\n                <span class="pg-pill">Mastercard</span>\n                <span class="pg-pill">RuPay</span>\n              </div>\n            </div>\n\n            <div class="pg-row">\n              <input class="pg-input small" id="pg-exp-month" placeholder="MM" />\n              <input class="pg-input small" id="pg-exp-year" placeholder="YY" />\n              <input class="pg-input small" id="pg-cvv" placeholder="CVV" />\n            </div>\n\n            <label class="pg-save-card">\n              <input type="checkbox" id="pg-save-card" />\n              <span>Securely save this card for faster checkout</span>\n            </label>\n          </div>\n\n          \x3c!-- UPI --\x3e\n          <div class="pg-tab-panel pg-hidden" data-panel="upi">\n            <p class="pg-hint">Pay instantly using your UPI app.</p>\n            <div class="pg-chip-row">\n              <button class="pg-chip">GPay</button>\n              <button class="pg-chip">PhonePe</button>\n              <button class="pg-chip">Paytm</button>\n              <button class="pg-chip">Other UPI</button>\n            </div>\n            <input class="pg-input" id="pg-upi-id" placeholder="name@bank or UPI ID" />\n          </div>\n\n          \x3c!-- Wallets --\x3e\n          <div class="pg-tab-panel pg-hidden" data-panel="wallet">\n            <p class="pg-hint">Use one of your favourite wallets.</p>\n            <div class="pg-chip-row">\n              <button class="pg-chip">Amazon Pay</button>\n              <button class="pg-chip">PhonePe Wallet</button>\n              <button class="pg-chip">Paytm Wallet</button>\n            </div>\n          </div>\n\n          \x3c!-- Netbanking --\x3e\n          <div class="pg-tab-panel pg-hidden" data-panel="netbanking">\n            <p class="pg-hint">Pay directly from your bank account.</p>\n            <select class="pg-input" id="pg-bank">\n              <option value="">Select your bank</option>\n              <option value="hdfc">HDFC Bank</option>\n              <option value="sbi">State Bank of India</option>\n              <option value="icici">ICICI Bank</option>\n              <option value="axis">Axis Bank</option>\n              <option value="kotak">Kotak Mahindra Bank</option>\n            </select>\n          </div>\n\n          \x3c!-- COD --\x3e\n          <div class="pg-tab-panel pg-hidden" data-panel="cod">\n            <p class="pg-hint">\n              Pay in cash or card when the order is delivered. \n            </p>\n            <label class="pg-save-card">\n              <input type="checkbox" id="pg-cod-confirm" />\n              <span>I will keep exact change ready, if possible.</span>\n            </label>\n          </div>\n        </div>\n\n        <div class="pg-footer">\n          <div class="pg-secure">\n            <span class="pg-lock">ðŸ”’</span>\n            <span>256-bit SSL encryption. Your data is secure.</span>\n          </div>\n          <button id="pg-pay-btn" class="pg-btn">\n            Pay â‚¹${(n.amount/100).toFixed(2)}\n          </button>\n        </div>\n      </div>\n    `,document.body.appendChild(a);const t=()=>{document.getElementById("pg-root")?.remove()};a.querySelector(".pg-close-btn").onclick=t,a.querySelector(".pg-backdrop").onclick=t;const o=a.querySelectorAll(".pg-tab"),p=a.querySelectorAll(".pg-tab-panel");o.forEach(n=>{n.addEventListener("click",()=>{const e=n.getAttribute("data-tab");o.forEach(n=>n.classList.remove("pg-tab-active")),n.classList.add("pg-tab-active"),p.forEach(n=>{n.getAttribute("data-panel")===e?n.classList.remove("pg-hidden"):n.classList.add("pg-hidden")})})}),document.getElementById("pg-pay-btn").onclick=()=>{const n=a.querySelector(".pg-tab.pg-tab-active").getAttribute("data-tab"),t={method:n};"card"===n&&(t.card={number:document.getElementById("pg-card-num").value,expMonth:document.getElementById("pg-exp-month").value,expYear:document.getElementById("pg-exp-year").value,cvv:document.getElementById("pg-cvv").value}),"upi"===n&&(t.upi={id:document.getElementById("pg-upi-id").value}),"netbanking"===n&&(t.netbanking={bank:document.getElementById("pg-bank").value}),"wallet"===n&&(t.wallet={}),e(t)}},showResult(n){const e=document.querySelector(".pg-box");e&&(e.classList.remove("pg-animate-in"),e.classList.add("pg-animate-out"),setTimeout(()=>{e.innerHTML=`\n        <button class="pg-close-btn" aria-label="Close payment modal" onclick="document.getElementById('pg-root').remove()">&times;</button>\n        <div class="pg-header pg-center">\n          <h2>${n.status}</h2>\n          <p class="pg-provider">Reference: ${n.providerReference??"-"}</p>\n        </div>\n        <div class="pg-body pg-center">\n          <p class="pg-hint">${n.message??"You can safely close this window now."}</p>\n        </div>\n        <div class="pg-footer pg-center">\n          <button class="pg-btn" onclick="document.getElementById('pg-root').remove()">Close</button>\n        </div>\n      `,e.classList.remove("pg-animate-out"),e.classList.add("pg-animate-in")},200))}};!function(n){const e=document.createElement("style");e.innerHTML=n,document.head.appendChild(e)}('/* modal.css */\n#pg-root {\n  position: fixed;\n  inset: 0;\n  z-index: 9999;\n  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;\n}\n\n.pg-backdrop {\n  position: absolute;\n  inset: 0;\n  background: rgba(15, 23, 42, 0.55);\n  backdrop-filter: blur(4px);\n}\n\n.pg-box {\n  position: relative;\n  max-width: 480px;\n  width: 100%;\n  margin: 4rem auto;\n  background: radial-gradient(circle at top left, #111827, #020617);\n  color: #e5e7eb;\n  border-radius: 18px;\n  box-shadow:\n    0 24px 60px rgba(15, 23, 42, 0.6),\n    0 0 0 1px rgba(148, 163, 184, 0.25);\n  padding: 20px 22px 18px;\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.pg-animate-in {\n  animation: pgFadeInUp 0.2s ease-out;\n}\n.pg-animate-out {\n  animation: pgFadeOutDown 0.18s ease-in forwards;\n}\n\n@keyframes pgFadeInUp {\n  from {\n    opacity: 0;\n    transform: translateY(12px) scale(0.98);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n}\n\n@keyframes pgFadeOutDown {\n  from {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n  }\n  to {\n    opacity: 0;\n    transform: translateY(8px) scale(0.97);\n  }\n}\n\n.pg-close-btn {\n  position: absolute;\n  top: 10px;\n  right: 12px;\n  border: none;\n  background: transparent;\n  color: #9ca3af;\n  font-size: 22px;\n  cursor: pointer;\n  line-height: 1;\n  padding: 4px;\n  border-radius: 999px;\n  transition: background 0.16s ease, color 0.16s ease, transform 0.12s ease;\n}\n.pg-close-btn:hover {\n  background: rgba(15, 23, 42, 0.7);\n  color: #e5e7eb;\n  transform: translateY(-1px);\n}\n\n.pg-header {\n  display: flex;\n  justify-content: space-between;\n  gap: 12px;\n  align-items: flex-start;\n}\n.pg-header h2 {\n  margin: 0;\n  font-size: 1.2rem;\n  letter-spacing: 0.01em;\n}\n.pg-subtitle {\n  margin: 2px 0 0;\n  font-size: 0.8rem;\n  color: #9ca3af;\n}\n.pg-amount-chip {\n  background: radial-gradient(circle at top left, #22c55e33, #0f172a);\n  border-radius: 999px;\n  padding: 8px 14px;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  gap: 2px;\n  border: 1px solid rgba(34, 197, 94, 0.3);\n}\n.pg-amount-chip span {\n  font-size: 0.7rem;\n  color: #9ca3af;\n}\n.pg-amount-chip strong {\n  font-size: 0.95rem;\n}\n\n.pg-tabs {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n  background: rgba(15, 23, 42, 0.85);\n  padding: 4px;\n  border-radius: 999px;\n}\n.pg-tab {\n  flex: 1 1 auto;\n  border: none;\n  font-size: 0.7rem;\n  padding: 6px 8px;\n  border-radius: 999px;\n  background: transparent;\n  color: #9ca3af;\n  cursor: pointer;\n  transition: background 0.15s ease, color 0.15s ease, transform 0.12s ease;\n}\n.pg-tab-active {\n  background: linear-gradient(135deg, #22c55e, #16a34a);\n  color: #022c22;\n  font-weight: 600;\n  transform: translateY(-1px);\n}\n\n.pg-body {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n.pg-row {\n  display: flex;\n  gap: 8px;\n}\n.pg-card-row {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n.pg-card-brands {\n  display: flex;\n  gap: 4px;\n}\n.pg-pill {\n  font-size: 0.65rem;\n  padding: 4px 8px;\n  border-radius: 999px;\n  border: 1px solid rgba(148, 163, 184, 0.5);\n  color: #e5e7eb;\n}\n\n.pg-input {\n  width: 100%;\n  padding: 9px 11px;\n  border-radius: 10px;\n  border: 1px solid rgba(148, 163, 184, 0.5);\n  background: rgba(15, 23, 42, 0.8);\n  color: #e5e7eb;\n  font-size: 0.8rem;\n  outline: none;\n  transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;\n}\n.pg-input::placeholder {\n  color: #6b7280;\n}\n.pg-input:focus {\n  border-color: #22c55e;\n  box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.4);\n  background: rgba(15, 23, 42, 1);\n}\n\n.pg-input.small {\n  max-width: 80px;\n}\n\n.pg-save-card {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 0.75rem;\n  color: #9ca3af;\n  margin-top: 4px;\n}\n\n.pg-hint {\n  margin: 0;\n  font-size: 0.75rem;\n  color: #9ca3af;\n}\n\n.pg-chip-row {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 6px;\n  margin: 6px 0 4px;\n}\n.pg-chip {\n  border-radius: 999px;\n  border: 1px solid rgba(148, 163, 184, 0.6);\n  padding: 5px 10px;\n  background: rgba(15, 23, 42, 0.9);\n  color: #e5e7eb;\n  font-size: 0.7rem;\n  cursor: pointer;\n  transition: background 0.15s ease, border-color 0.15s ease, transform 0.12s ease;\n}\n.pg-chip:hover {\n  background: rgba(34, 197, 94, 0.06);\n  border-color: #22c55e;\n  transform: translateY(-0.5px);\n}\n\n.pg-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  gap: 10px;\n  margin-top: 6px;\n}\n.pg-secure {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 0.7rem;\n  color: #9ca3af;\n}\n.pg-lock {\n  font-size: 0.8rem;\n}\n\n.pg-btn {\n  border: none;\n  border-radius: 999px;\n  padding: 9px 18px;\n  font-size: 0.8rem;\n  font-weight: 600;\n  cursor: pointer;\n  background: linear-gradient(135deg, #22c55e, #16a34a);\n  color: #022c22;\n  box-shadow: 0 14px 30px rgba(34, 197, 94, 0.4);\n  white-space: nowrap;\n  transition: transform 0.12s ease, box-shadow 0.12s ease, filter 0.12s ease;\n}\n.pg-btn:hover {\n  transform: translateY(-1px);\n  filter: brightness(1.03);\n  box-shadow: 0 18px 36px rgba(34, 197, 94, 0.5);\n}\n.pg-btn:active {\n  transform: translateY(0);\n  box-shadow: 0 8px 20px rgba(34, 197, 94, 0.35);\n}\n\n.pg-tab-panel.pg-hidden {\n  display: none;\n}\n\n.pg-center {\n  text-align: center;\n  align-items: center;\n  justify-content: center;\n}\n\n@media (max-width: 640px) {\n  .pg-box {\n    margin: 2.5rem 12px;\n    padding: 18px 16px 14px;\n  }\n  .pg-tabs {\n    border-radius: 12px;\n  }\n  .pg-header {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n  .pg-footer {\n    flex-direction: column-reverse;\n    align-items: stretch;\n  }\n  .pg-btn {\n    width: 100%;\n    justify-content: center;\n    text-align: center;\n  }\n}\n');function e(n=""){return n.startsWith("4")?"VISA":n.startsWith("5")?"MASTERCARD":n.startsWith("6")?"RUPAY":"UNKNOWN"}function a(n=""){return n.includes("okhdfc")?"gpay":n.includes("ybl")?"phonepe":n.includes("paytm")?"paytm":"other"}window.PaymentGateway=class{constructor({key:n,baseUrl:e}){this.key=n,this.baseUrl=e}open(t){n.open(t,async o=>{let p={};if("card"===o.method){p={paymentMethodToken:await async function(n,e,a){const t=await fetch("http://localhost:8800/api/v1/tokenization/tokenize-card",{method:"POST",headers:{"Content-Type":"application/json","X-API-KEY":"test_key_123",Authorization:`Basic ${a}`},body:JSON.stringify({type:"card",cardNumber:e.card.number,expMonth:e.card.expMonth,expYear:e.card.expYear,cvv:e.card.cvv,cardHolderName:"Dummy"})}),o=await t.json();if(!t.ok)throw new Error(o.message||"Tokenization failed");return o.token}(this.baseUrl,o,this.key),paymentMethod:"CARD",cardNetwork:e(o.card.number)}}else if("upi"===o.method){p={paymentMethodToken:await async function(n,e,a){const t=await fetch(`${n}/tokenize/payment-token`,{method:"POST",headers:{"Content-Type":"application/json","X-API-KEY":"test_key_123",Authorization:`Basic ${a}`},body:JSON.stringify({type:"upi",upi:{id:e}})}),o=await t.json();if(!t.ok)throw new Error(o.message||"UPI tokenization failed");return o.token}(this.baseUrl,o.upi.id,this.key),paymentMethod:"UPI",upiApp:a(o.upi.id)}}else"netbanking"===o.method?p={paymentMethodToken:"netbanking_dummy",paymentMethod:"NET_BANKING",bankCode:o.netbanking.bank}:"wallet"===o.method&&(p={paymentMethodToken:"wallet_dummy",paymentMethod:"WALLET"});const i=await async function(n,e,a,t){const o=await fetch(`${n}/payment_intents/${e}/confirm`,{method:"POST",headers:{"Content-Type":"application/json","X-API-KEY":"test_key_123",Authorization:`Basic ${t}`},body:JSON.stringify(a)}),p=await o.json();if(!o.ok)throw new Error(p.message||"Payment failed");return p}(this.baseUrl,t.intentId,p,this.key);n.showResult(i)})}}}();
